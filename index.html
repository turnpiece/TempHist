<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <title>TempHist &ndash; the temperature on this day each year</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js" defer></script>
    <script
      src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0/dist/chartjs-plugin-annotation.min.js"
      defer
    ></script>
    <link rel="dns-prefetch" href="https://api.temphist.com" />
    <link rel="stylesheet" href="styles.min.css" />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "TempHist",
      "description": "Daily temperature history chart showing how today's temperature compares to the same date over the past 50 years for your location.",
      "url": "https://temphist.com",
      "applicationCategory": "WeatherApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "Turnpiece"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Turnpiece",
        "url": "https://turnpiece.com"
      },
      "featureList": [
        "Historical temperature comparison",
        "Location-based weather data",
        "Interactive temperature charts",
        "50-year historical data",
        "Daily, weekly, monthly, and yearly views"
      ],
      "browserRequirements": "Requires JavaScript and location access",
      "screenshot": "https://temphist.com/assets/logo.png"
    }
    </script>
  </head>
  <body>
    <header id="header">
      <div class="header-left">
        <a href="#/today">
          <div id="logo">
            <object data="assets/logo.svg" type="image/svg+xml" title="TempHist">
              <img
                src="assets/logo.png"
                alt="TempHist logo"
                width="50"
                height="50"
              />
            </object>
          </div>
          <h1>TempHist</h1>
        </a>
      </div>
      <button id="burgerBtn" aria-label="Open menu" aria-controls="sidebar" aria-expanded="false">‚ò∞</button>
    </header>

    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
      <div class="splash-content">
        <div class="splash-logo">
          <object data="assets/logo.svg" type="image/svg+xml" title="TempHist">
            <img
              src="assets/logo.png"
              alt="TempHist logo"
              width="80"
              height="80"
            />
          </object>
        </div>
        <h1 class="splash-title">TempHist</h1>
        <h2 class="splash-subtitle">Temperature history: how does the temperature now compare to temperatures over the past half century?</h2>
        <div class="splash-intro">See how
          <ul>
            <li>today's temperature compares to the same date</li>
            <li>this past week's temperature compares to the same week</li>
            <li>this past moonth's temperature compares to the same month</li>
            <li>this past year's temperature compares to the same year</li>
          </ul> 
          over the past 50 years.</div>

        <div class="splash-description">
          <p>TempHist needs your location to show you historical temperature data for your area. <a href="/privacy" target="_blank">We don't store or share your location data</a>.</p>
        </div>
        
        <div class="splash-actions">
          <button id="useLocationBtn" class="btn btn-primary">
            üìç Use my location
          </button>
          <button id="chooseLocationBtn" class="btn btn-secondary">
            üåç Choose a location manually
          </button>
        </div>
        
        <!-- Manual location selection (initially hidden) -->
        <div id="manualLocationSection" class="manual-location-section" style="display: none;">
          <div class="location-dropdown-container">
            <label for="locationSelect" class="location-label">Select your location:</label>
            <select id="locationSelect" class="location-select">
              <option value="">Loading locations...</option>
            </select>
          </div>
          <div class="location-actions">
            <button id="confirmLocationBtn" class="btn btn-primary" disabled>
              Continue with selected location
            </button>
            <button id="backToSplashBtn" class="btn btn-secondary">
              ‚Üê Back to options
            </button>
          </div>
        </div>
        
        <!-- Loading state for location detection -->
        <div id="locationLoading" class="location-loading" style="display: none;">
          <div class="spinner"></div>
          <p class="loading-text">Detecting your location...</p>
        </div>
      </div>
    </div>

    <div id="appShell" class="hidden">
      <nav id="sidebar" aria-label="Primary">
        <ul>
          <li><a href="#/today" data-route="/today">Today</a></li>
          <li><a href="#/week" data-route="/week">Past week</a></li>
          <li><a href="#/month" data-route="/month">Past month</a></li>
          <li><a href="#/year" data-route="/year">Past year</a></li>
          <li><a href="#/about" data-route="/about">About</a></li>
          <li><a href="#/privacy" data-route="/privacy">Privacy</a></li>
        </ul>
      </nav>

      <main id="viewOutlet" role="main">
        <!-- Default view (Today) keeps your existing chart DOM -->
        <section id="todayView" data-view="today">
          <div class="container">
            <h2 id="dateText" class="date-heading"></h2>
            <div id="locationText" class="standard-text"></div>
            <div id="dataNotice" class="notice"></div>
            <div id="summaryText" class="standard-text"></div>
            
            <div class="chart-container">
              <div id="loading" class="loading">
                <div class="spinner"></div>
                <p id="loadingText" class="loading-text">Loading temperature data‚Ä¶</p>
              </div>
              
              <div id="errorContainer" class="error-container" style="display: none;">
                <div class="error-content">
                  <div id="errorMessage" class="error-message"></div>
                  <button id="reloadButton" class="reload-button">Reload</button>
                </div>
              </div>
              
              <canvas id="tempChart"></canvas>
            </div>
            
            <div id="avgText" class="standard-text"></div>
            <div id="trendText" class="standard-text"></div>
          </div>
        </section>

        <!-- Placeholders for other pages (rendered dynamically) -->
        <section id="weekView" data-view="week" hidden></section>
        <section id="monthView" data-view="month" hidden></section>
        <section id="yearView" data-view="year" hidden></section>
        
        <!-- Static pages integrated into SPA -->
        <section id="aboutView" data-view="about" hidden></section>
        <section id="privacyView" data-view="privacy" hidden></section>
      </main>
    </div>


    <script type="module" src="/src/main.ts" defer></script>
  </body>
</html>
